[toc]

# Linux 文件

> Linux系统中一切皆文件

## 目录规范

- bin 常用的命令
- sbin 系统管理员命令
- lib 当前的库目录
- boot 引导启动文件
- dev 管理设备
- etc 系统配置文件
- home 普通用户的主目录
- root 超级管理员的主目录
- opt 可选目录 第三方软件包的存放目录
- media 识别可移动媒体
- mnt 类似于media
- proc 当前进程的文件
- run 运行目录，当前运行的程序信息
- srv 系统服务
- sys 系统硬件信息文件
- tmp 临时目录
- var 可变目录 日志

## 目录信息

### 查看目录信息 ls

~~~ shell
junhsiun@Junhsiun:/home$ ls -l   # 查看详细信息
total 4
drwxr-x--- 3 junhsiun junhsiun 4096 Jun 15 15:43 junhsiun
~~~

| 部分           | 值           | 含义                           |
| -------------- | ------------ | ------------------------------ |
| 文件类型与权限 | drwxr-x---   | 文件类型和权限标识             |
| 硬链接数       | 3            | 目录的硬链接数量               |
| 所有者         | junhsiun     | 文件/目录的所有者用户          |
| 所属组         | junhsiun     | 文件/目录的所属用户组          |
| 大小           | 4096         | 目录的磁盘占用大小，通常最小4k |
| 最后修改时间   | Jun 15 15:43 | 最后修改的日期和时间           |
| 名称           | junhsiun     | 文件或目录的名称               |

### 文件类型与权限

#### 第1个字符：文件类型

| 属性 | 文件类型                                           |
| ---: | :------------------------------------------------- |
|    - | 常规文件                                           |
|    d | 目录文件                                           |
|    b | 块设备文件，如硬盘。支持以块为单位进行随机访问     |
|    c | 字符设备文件，如键盘。支持以字符为单位进行线性访问 |
|    l | 符号链接文件，又称为软链接文件                     |
|    p | 命名管道文件                                       |
|    s | 套接字，用于实现两个进程间的通信                   |

#### 其余字符 2—10：权限类型

剩下九个字符分为三组，每组三个字符，三组字符分别对应：

* 所有者
* 所属组
* 其他用户

每组字符的三个字符含义

1. r：可读取内容
2. w：可修改内容
3. x：可进入目录或可执行文件

#### 权限数字计算

权限数字由三位数字组成，每一位数字对应一组权限

1. 第一位：所有者权限
2. 第二位：所属组权限
3. 第三位：其他用户权限

每位数字的计算规则，将所需权限的数字值相加

| 权限 | 二进制 | 数字值 | 作用 |
| ---- | ------ | ------ | ---- |
| r    | 100    | 4      | 读   |
| w    | 010    | 2      | 写   |
| x    | 001    | 1      | 执行 |

> [!tip]
>
> 例如rwx = 4+2+1 = 7
>
> * 7：r w x 读、写、执行
> * 6：r w - 读、写
> * 5：r - x 读、执行
> * 4：r- -  只读
> * 0：- - -  无权限
>
> * 750  —> r w x r - x - - - 
>   * 所有者 7 = rwx 完全控制
>   * 所属组 5 = r-x 可读，可进入目录，但不可修改
>   * 其他用户 0 = - - - 无任何权限

设置文件或目录的权限

 ~~~ shell
 chmod 750 <文件名或目录名>
 chmod 750 /home/junshiun
 ~~~

## 文件操作

~~~ shell
touch test  # 创建空文件， 名称为“test”
cp test test1 # 复制test文件，命名为test1
mkdir testdir # 创建目录“testdir”
ln test testa # 创建test文件的硬链接
ln -s test testb # 创建test文件的软链接
mv testa testdir # 移动testa文件到testdir
mv test testdir/test1 # 移动test文件到testdir，顺便重命名为test1
cd testdir # 打开testdir目录
rm testb # 删除testb文件
cd .. # 返回上一级文件
rm -rf testdir # 强制删除testdir文件，即使里面还有其他文件，一并删除
pwd # 显示当前路径
~~~

> [!tip]
>
> #### 硬链接
>
> * 与原始文件共享相同的inode和数据块，本质是同一个文件的多个别名。
> * 删除原始文件后，硬链接仍能访问数据，只有当所有的硬链接被删除后，文件才会被真的释放。
> * 不能跨文件系统（从/home链接到/mnt会失败）
> * 不能对目录创建硬链接（仅限文件）
>
> #### 软链接 （符号链接）
>
> * 是一个独立的文件，仅存储源文件的路径（类似于windows种的快捷方式）。
> * 删除原始文件后，符号链接会失效（成为“悬空链接”）
> * 可以跨文件系统，可以对目录创建
> * 权限显示为`lrwxrwxrwx`，实际权限由源文件决定

